{% extends 'base.html.twig' %}

{% block title %}{{ animal.name }} - Nos rescapés{% endblock %}

{% block body %}
<div class="animal-show-page">
    <div class="animal-show-container">
        {# Section principale avec photo circulaire et infos #}
        <div class="animal-profile-wrapper">
            {# Cercles rotatifs #}
            <div class="circle-container">
                <div class="circle-rotate"></div>
                <div class="circle-rotate2"></div>
            </div>

            {# Photo de profil circulaire #}
            <div class="profile-img">
                {% if animal.imageName %}
                    <img src="{{ asset('uploads/images/' ~ animal.imageName) }}" alt="{{ animal.name }}">
                {% else %}
                    <div class="placeholder-image">
                        <i class="fas fa-paw"></i>
                    </div>
                {% endif %}
            </div>

            {# Nom (au-dessus) #}
            <div class="info-box info-nom">{{ animal.name }}</div>

            {# Sexe (gauche) #}
            <div class="info-box info-sexe">
                {% if animal.sexe == 'male' %}
                    <i class="fas fa-mars"></i> Mâle
                {% else %}
                    <i class="fas fa-venus"></i> Femelle
                {% endif %}
            </div>

            {# Âge (en haut à gauche) #}
            <div class="info-box info-age">{{ animal.age }}</div>

            {# Date d'arrivée (en haut à droite) #}
            <div class="info-box info-arrivee">
                Arrivée : {{ animal.dateArrivee|date('m/Y') }}
            </div>

            {# Association (droite) #}
            <div class="info-box info-asso">
                {% if animal.association %}
                    {{ animal.association.name }}
                {% else %}
                    Non renseigné
                {% endif %}
            </div>

            {# Ville (en bas) #}
            <div class="info-box info-ville">
                {% if animal.association and animal.association.codePostal %}
                    {{ animal.association.codePostal }}
                {% else %}
                    Lieu non renseigné
                {% endif %}
            </div>
        </div>

        {# Bouton favoris #}
        <button class="fav-button favorite-btn" data-animal-id="{{ animal.id }}">
            <i class="far fa-heart"></i>
        </button>

        {# Description #}
        <div class="animal-description-box">
            <p>{{ animal.description }}</p>
        </div>

        {# Tags comportementaux #}
        {% set behavioralTags = [] %}
        {% if animal.tag is not empty %}
            {% for tag in animal.tag %}
                {% if not (tag.type|lower == 'sos' or 'education' in tag.type|lower or tag.type|lower == 'fad') %}
                    {% set behavioralTags = behavioralTags|merge([tag]) %}
                {% endif %}
            {% endfor %}
        {% endif %}

        {% if behavioralTags is not empty %}
            <div class="animal-tags-section">
                <h3>Son caractère</h3>
                <div class="tags-container">
                    {% for tag in behavioralTags %}
                        {% set tagClass = tag.type|lower|replace({' ': '-', '\'': '', 'é': 'e', 'è': 'e'}) %}
                        <span class="tag {{ tagClass }}">
                            {{ tag.type }}
                        </span>
                    {% endfor %}
                </div>
            </div>
        {% endif %}

        {# Boutons d'action #}
        <div class="action-buttons">
            <a href="{{ path('animals') }}" class="btn-back">
                <i class="fas fa-arrow-left"></i> Retour à la liste
            </a>
            <button class="btn-contact">
                <i class="fas fa-envelope"></i> Contacter l'association
            </button>
        </div>
    </div>
</div>
{% endblock %}
